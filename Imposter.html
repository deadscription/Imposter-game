<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Imposter Game</title>
  <style>
    #numberButtons button.available { background-color: #8BC34A; color: white; margin: 5px; padding: 10px; }
    #numberButtons button.taken { background-color: #B0BEC5; color: white; margin: 5px; padding: 10px; }
    #wordBox { display: none; margin-top: 20px; font-size: 1.5em; }
  </style>
</head>
<body>
  <h1>Imposter Game</h1>
  <div id="numberButtons"></div>
  <div id="wordBox"></div>
  <button id="newRoundBtn">Start New Round</button>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
  // ---------------- Firebase config ----------------
  const firebaseConfig = {
    apiKey: "AIzaSyDvpa6IP-gjyVVg_lFizwMNjflqbJMw2uQ",
    authDomain: "imposter-game-515d8.firebaseapp.com",
    databaseURL: "https://imposter-game-515d8-default-rtdb.firebaseio.com",
    projectId: "imposter-game-515d8",
    storageBucket: "imposter-game-515d8.firebasestorage.app",
    messagingSenderId: "727642877069",
    appId: "1:727642877069:web:35f0113718fdde270b06c4"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // --------------- Health Check & Start Game ---------------
  firebase.auth().signInAnonymously()
    .then(() => {
      console.log("✅ Anonymous sign-in successful");
      // quick write/read test
      const testRef = db.ref("healthCheck/test");
      testRef.set({ timestamp: Date.now() })
        .then(() => testRef.once("value"))
        .then(snapshot => {
          console.log("✅ Database test passed, starting game!");
          startGame();
        })
        .catch(err => {
          console.error("❌ Database test failed:", err);
          alert("Database access failed. Check Firebase rules.");
        });
    })
    .catch(err => {
      console.error("❌ Auth failed:", err);
      alert("Firebase sign-in failed. Check console.");
    });

  // ----------------- Game Logic -----------------
  function startGame() {
    const secretWords = ["pizza","moon","guitar","jungle","volcano","camera","robot","beach","pyramid","penguin","castle","carrot","mountain","computer","ocean"];
    const params = new URLSearchParams(window.location.search);
    let seed = params.get("seed");
    if(!seed){
      seed = Math.floor(Math.random()*1000000);
      window.location.search = "?seed=" + seed;
    }

    function seededRandom(s
